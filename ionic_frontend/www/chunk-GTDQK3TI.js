import{b as k,c as K}from"./chunk-XOXIFAI4.js";import"./chunk-FG76RZX6.js";import{$a as P,Aa as G,Ba as j,C as d,Ca as q,D as i,E as e,F as h,Fa as x,Ga as M,Ha as N,Ia as U,K as p,T as l,_a as D,ab as V,ga as I,gb as w,ia as y,ib as B,jb as H,kb as L,nb as z,rb as A,sb as R,u as g,v as u,va as m,vb as J,wa as E,x as _,xa as T}from"./chunk-ABGFETKJ.js";import"./chunk-7DWWQGY5.js";import"./chunk-RUV3JLHO.js";import"./chunk-4QCDUIMV.js";import"./chunk-PZSC2JZC.js";import"./chunk-HC6MZPB3.js";import"./chunk-RWUDUHQX.js";import"./chunk-OYGTIZD7.js";import"./chunk-3H72FJST.js";import"./chunk-LDMQELEG.js";import"./chunk-LEIMCQKJ.js";import"./chunk-ZOGHNDC5.js";import"./chunk-57V45CII.js";import"./chunk-RTD7OIC3.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-FQYCRHA2.js";import"./chunk-MCRJI3T3.js";import"./chunk-MJBR6MFX.js";import"./chunk-DPWJJFUE.js";import"./chunk-LZRXIYDK.js";import"./chunk-AYPA7D57.js";import"./chunk-NH7O73XC.js";import"./chunk-LYYJ2XOB.js";import"./chunk-4U6PRYVA.js";import"./chunk-U6SBTS4X.js";import"./chunk-JWIEPCRG.js";import"./chunk-C5RQ2IC2.js";import"./chunk-D4VGNZLR.js";import"./chunk-JHLW7V75.js";import"./chunk-SV7S5NYR.js";import{f as C}from"./chunk-RW4GY4BD.js";var te=(()=>{let s=class s{constructor(n,o,t,a){this.fb=n,this.http=o,this.authService=t,this.toast=a,this.apiUrl="http://localhost:3000/api/games/upload",this.gameForm=this.fb.group({name:["",m.required],description:["",m.required],icon:[null,m.required],html:[null,m.required],js:[null,m.required],css:[null,m.required]})}onFileChange(n,o){var a;let t=n.target.files[0];t&&(this.gameForm.patchValue({[o]:t}),(a=this.gameForm.get(o))==null||a.updateValueAndValidity())}submitGame(){var o,t,a,r,v,F;if(this.gameForm.invalid){console.error("Form is invalid"),this.presentToast("Please fill all fields correctly.","danger");return}if(!this.authService.isLoggedIn){this.authService.logout("utente non autenticato, impossibile caricare il gioco");return}let n=new FormData;n.append("name",(o=this.gameForm.get("name"))==null?void 0:o.value),n.append("description",(t=this.gameForm.get("description"))==null?void 0:t.value),n.append("icon",(a=this.gameForm.get("icon"))==null?void 0:a.value),n.append("html",(r=this.gameForm.get("html"))==null?void 0:r.value),n.append("js",(v=this.gameForm.get("js"))==null?void 0:v.value),n.append("css",(F=this.gameForm.get("css"))==null?void 0:F.value),this.http.post(this.apiUrl,n,{withCredentials:!0}).subscribe({next:c=>{this.presentToast(c.message,"success"),console.log(c)},error:c=>{var b;let S=((b=c.error)==null?void 0:b.message)||"Caricamento fallito, per favore riprova.";this.presentToast(S,"danger"),console.error(S,c)}})}presentToast(n,o="primary"){return C(this,null,function*(){(yield this.toast.create({message:n,duration:5e3,color:o,position:"top"})).present()})}};s.\u0275fac=function(o){return new(o||s)(u(M),u(y),u(K),u(k))},s.\u0275cmp=_({type:s,selectors:[["app-upload-game"]],decls:39,vars:4,consts:[[3,"translucent"],["slot","start"],[3,"fullscreen"],["collapse","condense"],["size","large"],[3,"ngSubmit","formGroup"],["position","floating"],["type","text","formControlName","name","required",""],["type","text","formControlName","description","required",""],["type","file","accept","image/*",3,"change"],["type","file","accept",".html",3,"change"],["type","file","accept",".css",3,"change"],["type","file","accept",".js",3,"change"],["expand","full","type","submit",2,"padding","20px",3,"disabled"]],template:function(o,t){o&1&&(i(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),h(3,"ion-menu-button"),e(),i(4,"ion-title"),l(5,"Carica il tuo gioco"),e()()(),i(6,"ion-content",2)(7,"ion-card")(8,"ion-header",3)(9,"ion-toolbar")(10,"ion-title",4),l(11,"Carica il tuo gioco"),e()()(),i(12,"form",5),p("ngSubmit",function(){return t.submitGame()}),i(13,"ion-item")(14,"ion-label",6),l(15,"Nome del gioco"),e(),h(16,"ion-input",7),e(),i(17,"ion-item")(18,"ion-label",6),l(19,"Descrizione"),e(),h(20,"ion-input",8),e(),i(21,"ion-item")(22,"ion-label"),l(23,"Immagine di copertina"),e(),i(24,"input",9),p("change",function(r){return t.onFileChange(r,"icon")}),e()(),i(25,"ion-item")(26,"ion-label"),l(27,"File HTML"),e(),i(28,"input",10),p("change",function(r){return t.onFileChange(r,"html")}),e()(),i(29,"ion-item")(30,"ion-label"),l(31,"File CSS"),e(),i(32,"input",11),p("change",function(r){return t.onFileChange(r,"css")}),e()(),i(33,"ion-item")(34,"ion-label"),l(35,"File JS"),e(),i(36,"input",12),p("change",function(r){return t.onFileChange(r,"js")}),e()(),i(37,"ion-button",13),l(38,"Carica Gioco"),e()()()()),o&2&&(d("translucent",!0),g(6),d("fullscreen",!0),g(6),d("formGroup",t.gameForm),g(25),d("disabled",t.gameForm.invalid))},dependencies:[V,J,H,D,w,B,A,R,I,N,G,E,T,x,P,z,L,U,j,q],encapsulation:2});let f=s;return f})();export{te as UploadGamePage};
